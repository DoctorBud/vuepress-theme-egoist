(window.webpackJsonp=window.webpackJsonp||[]).push([[43],{155:function(t,s,n){"use strict";n.r(s);var a={props:["target"]},e=n(20),r=Object(e.a)(a,function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("div",{staticClass:"content"},[n("p",[n("a",{attrs:{href:"https://github.com/egoist/rollup-plugin-postcss",target:"_blank",rel:"noopener noreferrer"}},[t._v("rollup-plugin-postcss"),n("OutboundLink")],1),t._v(" 是我两年前开源的一个项目，用于为 "),n("a",{attrs:{href:"https://rollupjs.org/guide/en",target:"_blank",rel:"noopener noreferrer"}},[t._v("Rollup"),n("OutboundLink")],1),t._v(" 提供 "),n("a",{attrs:{href:"https://github.com/postcss/postcss",target:"_blank",rel:"noopener noreferrer"}},[t._v("PostCSS"),n("OutboundLink")],1),t._v(" 支持。")]),t._v(" "),n("p",[t._v("这基本上是我刚开始工作的时候写的代码，所以见证了我一段心路历程。")]),t._v(" "),t._m(0),t._v(" "),n("p",[t._v("我"),n("a",{attrs:{href:"https://github.com/egoist/rollup-plugin-postcss/commit/ed445b067e0772aa39403db23bfb2bc4b6129aef#diff-04c6e90faac2675aa89e2176d2eec7d8",target:"_blank",rel:"noopener noreferrer"}},[t._v("首次提交了代码"),n("OutboundLink")],1),t._v("，那个时候我的邮箱还是 "),n("code",[t._v("aprilorange.net@icloud.com")]),t._v("[^1]，不过早已由于忘记密码且无法申诉而永久无法登录了。")]),t._v(" "),t._m(1),t._v(" "),t._m(2),n("p",[t._v("之后就在当天，我向 PostCSS 项目提交 PR 请求在 README 上列出我的这个项目，而这个 PR 的序号也很溜: https://github.com/postcss/postcss/pull/666")]),t._v(" "),n("p",[t._v("发这个 Issue 的时候我刚下班，骑着自行车回家的途中发现收到了回复，我就停下车来，靠着自行车在成都万象城旁边傻站着摸着手机回复。")]),t._v(" "),n("p",[t._v("PostCSS 的维护者告诉我应该使用异步的 API，我也就照做了，然后就发生了:")]),t._v(" "),t._m(3),t._v(" "),n("p",[t._v("其实我当时还不太懂 Promise，经他指出之后研究了一下才发现一个函数已经返回了 Promise 就不用再把它 wrap 进一个 Promise 了:")]),t._v(" "),t._m(4),t._v(" "),n("p",[t._v("在这之后我也看到过其它人像我以前那样写，就感觉很好，因为我再也不会那么傻了。")]),t._v(" "),t._m(5),t._v(" "),n("p",[t._v("开源两周后，这个项目迎来了"),n("a",{attrs:{href:"https://github.com/egoist/rollup-plugin-postcss/issues/1",target:"_blank",rel:"noopener noreferrer"}},[t._v("第一个 Issue"),n("OutboundLink")],1),t._v("，我当时是很激动的:")]),t._v(" "),t._m(6),t._v(" "),n("p",[t._v("这个人可能在今天已经为读者们所熟知，也就是 "),n("a",{attrs:{href:"https://github.com/developit/preact",target:"_blank",rel:"noopener noreferrer"}},[t._v("Preact"),n("OutboundLink")],1),t._v(" 的作者，我记得在当时 Preact 还只有几百个 stars?")]),t._v(" "),t._m(7),t._v(" "),n("p",[t._v("半年没更新这个项目了，难道是没人用吗，我也不知道因为我自己也不用。不过当时我似乎挺喜欢用 "),n("a",{attrs:{href:"https://github.com/avajs/ava",target:"_blank",rel:"noopener noreferrer"}},[t._v("AVA"),n("OutboundLink")],1),t._v(" 写测试，因为 CLI 效果很炫而且默认就支持用 ES2015 写测试。")]),t._v(" "),n("p",[t._v("于是我就 commit 了一发"),n("a",{attrs:{href:"https://github.com/egoist/rollup-plugin-postcss/commit/9698d66ca1f04a2308c94fe74d94d184f2891b96",target:"_blank",rel:"noopener noreferrer"}},[t._v("将 Mocha 替换成 AVA"),n("OutboundLink")],1),t._v(" 了。")]),t._v(" "),n("p",[t._v("[^1]: 我的笔名叫四月橘林，所以当时英文名就叫 April Orange XD")]),t._v(" "),t._m(8),t._v(" "),n("p",[t._v("这天有人来了个 "),n("a",{attrs:{href:"https://github.com/egoist/rollup-plugin-postcss/pull/5",target:"_blank",rel:"noopener noreferrer"}},[t._v("PR"),n("OutboundLink")],1),t._v("，尽管不知道 fix 了什么我还是合了吧?")]),t._v(" "),n("p",[t._v("之后又来了一些 contributors，慢慢地我就懒得管了，基本全都是他们在 fix bugs 或者添加新 features，逐渐地我自己也看不懂里面的代码了 😅")]),t._v(" "),t._m(9),t._v(" "),n("p",[t._v("过了一年多，我突然找回了责任心，想起了那句责任越大能力越大，打算重写一下这个项目。在此之前我折腾了很久的 webpack，于是就得到了一些重写的灵感，想让这个插件以 "),n("code",[t._v("loader")]),t._v(" 的方式支持任何 CSS 预处理器，而且刚好 "),n("a",{attrs:{href:"https://github.com/parcel-bundler/parcel",target:"_blank",rel:"noopener noreferrer"}},[t._v("Parcel"),n("OutboundLink")],1),t._v(" 突然流行了起来，我也就顺便让它无需配置便能编译 CSS/Sass/Less/Stylus。和每次重构之后的心情一样，我再次觉得这次的代码写得很完美了。")]),t._v(" "),t._m(10),t._v(" "),t._m(11),t._v(" "),n("p",[t._v("今天，也就是我写这篇文章的日子，rollup-plugin-postcss 已被 "),n("a",{attrs:{href:"https://github.com/egoist/rollup-plugin-postcss/network/dependents",target:"_blank",rel:"noopener noreferrer"}},[t._v("900"),n("OutboundLink")],1),t._v(" 多个项目使用，其中包括像 "),n("a",{attrs:{href:"https://github.com/developit/microbundle",target:"_blank",rel:"noopener noreferrer"}},[t._v("microbundle"),n("OutboundLink")],1),t._v(" 和 "),n("a",{attrs:{href:"https://github.com/egoist/bili",target:"_blank",rel:"noopener noreferrer"}},[t._v("bili"),n("OutboundLink")],1),t._v(" 这样基于 Rollup 的打包工具。")]),t._v(" "),n("p",[t._v("照目前的趋势来看，目前的代码还没有崩坏的迹象，在一段时间内可读性还能维持在较高范围。")])])},[function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"_2015-年-12-月-8-日"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2015-年-12-月-8-日","aria-hidden":"true"}},[this._v("#")]),this._v(" 2015 年 12 月 8 日")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("当时的代码极为简单，仅仅是调用 "),s("code",[this._v("postcss")]),this._v(" 转换 CSS 代码并提供 "),s("code",[this._v("plugins")]),this._v(" 参数:")])},function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{attrs:{class:"token keyword"}},[t._v("import")]),t._v(" postcss "),n("span",{attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),n("span",{attrs:{class:"token string"}},[t._v("'postcss'")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{attrs:{class:"token keyword"}},[t._v("import")]),t._v(" styleInject "),n("span",{attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),n("span",{attrs:{class:"token string"}},[t._v("'style-inject'")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n \n"),n("span",{attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("default")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("options "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{attrs:{class:"token function"}},[t._v("intro")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),n("span",{attrs:{class:"token keyword"}},[t._v("return")]),t._v(" styleInject"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token function"}},[t._v("toString")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),n("span",{attrs:{class:"token function"}},[t._v("transform")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("code"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" id"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),n("span",{attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("id"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token function"}},[t._v("slice")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" "),n("span",{attrs:{class:"token operator"}},[t._v("-")]),n("span",{attrs:{class:"token number"}},[t._v("4")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{attrs:{class:"token operator"}},[t._v("!==")]),t._v(" "),n("span",{attrs:{class:"token string"}},[t._v("'.css'")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("null")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n      code "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{attrs:{class:"token function"}},[t._v("postcss")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("options"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("plugins "),n("span",{attrs:{class:"token operator"}},[t._v("||")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token function"}},[t._v("process")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("code"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("css"),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      code "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{attrs:{class:"token template-string"}},[n("span",{attrs:{class:"token string"}},[t._v("`export default styleInject(")]),n("span",{attrs:{class:"token interpolation"}},[n("span",{attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),n("span",{attrs:{class:"token constant"}},[t._v("JSON")]),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token function"}},[t._v("stringify")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("code"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),n("span",{attrs:{class:"token string"}},[t._v(");`")])]),t._v("\n      "),n("span",{attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        code"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        map"),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" mappings"),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{attrs:{class:"token string"}},[t._v("''")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n      "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("img",{attrs:{src:"https://i.loli.net/2018/02/27/5a94fe69825e3.png",alt:"lol"}})])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("img",{attrs:{src:"https://i.loli.net/2018/02/27/5a94fec490e73.png",alt:"promise"}})])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"_2015-年-12-月-23-日"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2015-年-12-月-23-日","aria-hidden":"true"}},[this._v("#")]),this._v(" 2015 年 12 月 23 日")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("img",{attrs:{src:"https://i.loli.net/2018/02/27/5a9500dcc43a7.png",alt:"issue 1"}})])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"_2016-年-5-月-29-日"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2016-年-5-月-29-日","aria-hidden":"true"}},[this._v("#")]),this._v(" 2016 年 5 月 29 日")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"_2016-年-9-月-2-日"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2016-年-9-月-2-日","aria-hidden":"true"}},[this._v("#")]),this._v(" 2016 年 9 月 2 日")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"_2018-年-1-月-10-日"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2018-年-1-月-10-日","aria-hidden":"true"}},[this._v("#")]),this._v(" 2018 年 1 月 10 日")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("img",{attrs:{src:"https://i.loli.net/2018/02/27/5a9505707f0ea.png",alt:"current"}})])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"_2018-年-2-月-27-日"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2018-年-2-月-27-日","aria-hidden":"true"}},[this._v("#")]),this._v(" 2018 年 2 月 27 日")])}],!1,null,null,null);s.default=r.exports}}]);