(window.webpackJsonp=window.webpackJsonp||[]).push([[39],{170:function(t,s,n){"use strict";n.r(s);var a={props:["target"]},e=n(6),o=Object(e.a)(a,function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("div",{staticClass:"content"},[n("p",[t._v("好的作品不在于其形式，重要的是内容，我的很多音乐作品都是没有名字的，然而没有名字的东西无法商业流通，所以你才会看到我那些没有特殊意义、单纯靠滚键盘得到的名字。 —— "),n("a",{attrs:{href:"http://music.163.com/#/artist?id=15290",target:"_blank",rel:"noopener noreferrer"}},[t._v("泽野弘之"),n("OutboundLink")],1),t._v("曾经这样说过(其实并没有)。")]),t._v(" "),n("p",[t._v("这篇文章也是这个道理，想介绍一下我在半年前开始做的脚手架工具。给文章起标题也是一件很困难的事，最开始想到的是「史上最优雅的脚手架工具」、「来自未来的脚手架」，不过这些未免显得太标题党了，华而不实我自己都很尴尬。最近我刚好做了个"),n("a",{attrs:{href:"https://github.com/egoist/evangelion-card",target:"_blank",rel:"noopener noreferrer"}},[t._v("新世纪福音战士标题卡生成器"),n("OutboundLink")],1),t._v("，于是就随机将几个关键词组合在一起 —— "),n("strong",[t._v("新世纪福音脚手架")]),t._v("，意外地显得还不错。")]),t._v(" "),t._m(0),t._v(" "),t._m(1),t._v(" "),t._m(2),t._v(" "),n("p",[t._v("经常造轮子就会发现脚手架的重要性，这也是为什么 Yeoman 的发明者之一是 "),n("a",{attrs:{href:"https://github.com/sindresorhus",target:"_blank",rel:"noopener noreferrer"}},[t._v("@sindresorhus"),n("OutboundLink")],1),t._v(" 的原因。后者已经在 npm 上发布了"),n("a",{attrs:{href:"https://www.npmjs.com/~sindresorhus",target:"_blank",rel:"noopener noreferrer"}},[t._v("超过 1000 个模块"),n("OutboundLink")],1),t._v("，很难后有来者了。")]),t._v(" "),n("p",[t._v("Yeoman 十分健壮，生态繁荣，然而要写"),n("a",{attrs:{href:"https://github.com/sindresorhus/generator-nm/blob/master/app/index.js",target:"_blank",rel:"noopener noreferrer"}},[t._v("一个 generator 的复杂度"),n("OutboundLink")],1),t._v("和写普通的代码几乎是差不多的，而我在能尽可能减少思考的时候就想减少思考，vue-cli 的思路很好地解决了我想减少思考的诉求，一个 generator 中间生成文件的过程有很多步骤是可以自动解决的。")]),t._v(" "),n("p",[t._v("vue-cli 虽然名字里有 vue 属性，但是作为任意类型项目的脚手架工具都是可以的，尽管运行 "),n("code",[t._v("vue init react")]),t._v(" 这样的命令会显得有些奇怪。这也是为什么我做了 "),n("a",{attrs:{href:"https://github.com/egoist/sao",target:"_blank",rel:"noopener noreferrer"}},[t._v("SAO"),n("OutboundLink")],1),t._v(" 的原因，一个类似 vue-cli 的脚手架工具。在拥有 vue-cli 的功能的同时，它也能像 Yeoman 一样用 npm package 作为模板并支持测试。")]),t._v(" "),t._m(3),t._v(" "),t._m(4),t._v(" "),t._m(5),t._m(6),t._v(" "),t._m(7),t._v(" "),n("p",[t._v("SAO 接收的第一个参数可以是:")]),t._v(" "),t._m(8),t._v(" "),n("p",[t._v("而第二个参数是可选的，不存在时将会生成文件到工作区目录（当前目录），否则将会生成到指定的文件夹中。")]),t._v(" "),t._m(9),t._v(" "),t._m(10),t._v(" "),t._m(11),t._v(" "),t._m(12),t._m(13),t._v(" "),t._m(14),t._m(15),t._v(" "),t._m(16),t._m(17),t._v(" "),n("p",[t._v("分享几个我自己经常使用的模板:")]),t._v(" "),n("ul",[n("li",[n("a",{attrs:{href:"https://github.com/egoist/template-nm",target:"_blank",rel:"noopener noreferrer"}},[t._v("template-nm"),n("OutboundLink")],1),t._v(": 生成一个 npm 模块，我的所有模块都是用这个生成的。")]),t._v(" "),n("li",[n("a",{attrs:{href:"https://github.com/egoist/template-vue",target:"_blank",rel:"noopener noreferrer"}},[t._v("template-vue"),n("OutboundLink")],1),t._v(": 生成一个"),n("em",[t._v("几乎")]),t._v("无需配置的 Vue 项目，基于 "),n("a",{attrs:{href:"https://poi.js.org",target:"_blank",rel:"noopener noreferrer"}},[t._v("Poi"),n("OutboundLink")],1),t._v("。")]),t._v(" "),n("li",[n("a",{attrs:{href:"https://github.com/egoist/awesome-sao",target:"_blank",rel:"noopener noreferrer"}},[t._v("awesome-sao"),n("OutboundLink")],1),t._v(": 相关 SAO 资源。")])]),t._v(" "),n("p",[t._v("关于更多 SAO 的使用方法和配置文件参数，可以访问 https://sao.js.org 😛 虽然本文标题是来源于新世纪福音战士，但 SAO 显然是来源于 "),n("a",{attrs:{href:"https://zh.moegirl.org/zh-hans/%E5%88%80%E5%89%91%E7%A5%9E%E5%9F%9F",target:"_blank",rel:"noopener noreferrer"}},[t._v("Sword Art Online"),n("OutboundLink")],1),t._v(" 的。")])])},[function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("img",{attrs:{src:"https://ooo.0o0.ooo/2017/05/21/5921898822cae.png",alt:"sao"}})])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("strong",[this._v("为了不让你对标题不明所以，简单地说明了它的来历，以下才是正文。")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"脚手架"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#脚手架","aria-hidden":"true"}},[this._v("#")]),this._v(" 脚手架")])},function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("p",[t._v("举个例子，在运行 "),n("code",[t._v("sao vue")]),t._v(" 的时候，如果 template-vue 这个 npm 模块没有全局安装，它会提示你安装，之后再使用模板根目录里的配置文件 "),n("code",[t._v("sao.js")]),t._v(" 将同目录里的 "),n("code",[t._v("template/")]),t._v(" 中的文件生成到 "),n("code",[t._v("process.cwd()")]),t._v(" 即当前目录。如果不存在配置文件，那么只会当成一个普通的目录，简单地复制粘贴到当前目录。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("📄 "),s("strong",[this._v("template-vue/sao.js:")])])},function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[t._v("module"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{attrs:{class:"token comment"}},[t._v("// 从用户获取一些信息")]),t._v("\n  prompts"),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    pwa"),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      type"),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{attrs:{class:"token string"}},[t._v("'confirm'")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      message"),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{attrs:{class:"token string"}},[t._v("'Add Progressive Web App support'")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),n("span",{attrs:{class:"token keyword"}},[t._v("default")]),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{attrs:{class:"token boolean"}},[t._v("true")]),t._v("\n    "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{attrs:{class:"token comment"}},[t._v("// 如果要发布到 npm")]),t._v("\n  "),n("span",{attrs:{class:"token comment"}},[t._v("// .gitignore 会自动被 npm 更名为 .npmignore")]),t._v("\n  "),n("span",{attrs:{class:"token comment"}},[t._v("// 为了避免这种情况需要起个另外的名字")]),t._v("\n  "),n("span",{attrs:{class:"token comment"}},[t._v("// 然后在生成的时候改名为 .gitignore")]),t._v("\n  move"),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    gitignore"),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{attrs:{class:"token string"}},[t._v("'.gitignore'")]),t._v("\n  "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{attrs:{class:"token comment"}},[t._v("// 只在用户确认了 pwa 选项的时候生成 pwa.js")]),t._v("\n  filters"),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{attrs:{class:"token string"}},[t._v("'pwa.js'")]),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{attrs:{class:"token string"}},[t._v("'pwa'")]),t._v("\n  "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("上面的这个配置文件满足了大部分脚手架的需求，即从用户获取信息 --\x3e 根据此信息生成需要的文件。而且几乎与代码无关，这个配置文件完全是由"),s("strong",[this._v("数据")]),this._v("组成的，只不过刚好是以 JS 对象的格式。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("img",{attrs:{src:"https://ooo.0o0.ooo/2017/05/21/59218de93485b.png",alt:"preview"}})])},function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("ul",[n("li",[t._v("本地模板路径，比如 "),n("code",[t._v("./my-template")]),t._v(" "),n("code",[t._v("/path/to/my-template")]),t._v("。")]),t._v(" "),n("li",[t._v("GitHub 项目缩略名，比如 "),n("code",[t._v("egoist/template-vue")]),t._v("。")]),t._v(" "),n("li",[t._v("npm 模块名(自动加上 "),n("code",[t._v("template-")]),t._v(" 前缀)，比如 "),n("code",[t._v("vue")]),t._v(" 将会使用 npm 上的 "),n("code",[t._v("template-vue")]),t._v(" 这个包。")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"测试脚手架"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#测试脚手架","aria-hidden":"true"}},[this._v("#")]),this._v(" 测试脚手架")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("当脚手架变得复杂，你需要系统地测试以便让其在各种情况下都能生成正确的文件。对于一个脚手架，能从用户影响到它的变量只有 "),s("code",[this._v("prompts")]),this._v(" 这个参数，也就是从用户获取的信息。而 SAO 的测试也主要是围绕这个来的，你可以模拟用户输入来检测生成结果。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("📄 "),s("strong",[this._v("template-vue/test.js:")])])},function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{attrs:{class:"token keyword"}},[t._v("import")]),t._v(" test "),n("span",{attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),n("span",{attrs:{class:"token string"}},[t._v("'ava'")]),t._v("\n"),n("span",{attrs:{class:"token keyword"}},[t._v("import")]),t._v(" sao "),n("span",{attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),n("span",{attrs:{class:"token string"}},[t._v("'sao'")]),t._v("\n\n"),n("span",{attrs:{class:"token function"}},[t._v("test")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token string"}},[t._v("'generate pwa entry'")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("async")]),t._v(" t "),n("span",{attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{attrs:{class:"token keyword"}},[t._v("const")]),t._v(" template "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" process"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token function"}},[t._v("cwd")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{attrs:{class:"token comment"}},[t._v("// 模板根目录")]),t._v("\n  "),n("span",{attrs:{class:"token keyword"}},[t._v("const")]),t._v(" res "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("await")]),t._v(" sao"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token function"}},[t._v("mockPrompt")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("template"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{attrs:{class:"token comment"}},[t._v("// 模拟的 prompts 数据")]),t._v("\n    "),n("span",{attrs:{class:"token comment"}},[t._v("// 默认使用 `prompts` 中的默认值")]),t._v("\n    "),n("span",{attrs:{class:"token comment"}},[t._v("// 在上面的 `sao.js` 中 `pwa` 默认为 `true`")]),t._v("\n  "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  t"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token boolean"}},[t._v("true")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("res"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("fileList"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token function"}},[t._v("includes")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token string"}},[t._v("'pwa.js'")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),n("span",{attrs:{class:"token function"}},[t._v("test")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token string"}},[t._v("'ignore pwa entry'")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("async")]),t._v(" t "),n("span",{attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{attrs:{class:"token keyword"}},[t._v("const")]),t._v(" template "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" process"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token function"}},[t._v("cwd")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{attrs:{class:"token comment"}},[t._v("// 模板根目录")]),t._v("\n  "),n("span",{attrs:{class:"token keyword"}},[t._v("const")]),t._v(" res "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("await")]),t._v(" sao"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token function"}},[t._v("mockPrompt")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("template"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    pwa"),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{attrs:{class:"token boolean"}},[t._v("false")]),t._v("\n  "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  t"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token boolean"}},[t._v("false")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("res"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("fileList"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token function"}},[t._v("includes")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token string"}},[t._v("'pwa.js'")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("这里的 "),s("code",[this._v("res.fileList")]),this._v(" 是生成的文件列表，形如:")])},function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n  "),n("span",{attrs:{class:"token string"}},[t._v("'.gitignore'")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{attrs:{class:"token string"}},[t._v("'pwa.js'")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{attrs:{class:"token string"}},[t._v("'src/index.js'")]),t._v("\n"),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("以及 "),s("code",[this._v("res.files")]),this._v("，包含了生成文件的信息:")])},function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{attrs:{class:"token string"}},[t._v("'.gitignore'")]),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    contents"),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Buffer"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    stats"),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{attrs:{class:"token comment"}},[t._v("// fs.Stats,")]),t._v("\n    path"),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{attrs:{class:"token string"}},[t._v("'/absolute/path/to/this/file'")]),t._v("\n  "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{attrs:{class:"token comment"}},[t._v("// ...")]),t._v("\n"),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"最后"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#最后","aria-hidden":"true"}},[this._v("#")]),this._v(" 最后")])}],!1,null,null,null);s.default=o.exports}}]);